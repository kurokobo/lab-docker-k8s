# Kubernetes Lab： はじめに

このラボでは、Docker ラボと同じアプリケーションを、今度は Kubernetes 上で動かしてみます。

## このラボの目的と概要

このラボでは、

- とにかく **Kubernetes** に触れてみる
- 任意のコンテナイメージを Kubernetes 上にデプロイできるようになる
- マニフェストファイルを扱える

ことを目的に、以下のトピックを取り扱います。

- Kubernetes クラスタの作成
- コンテナイメージのデプロイと公開
- マニフェストの作成とマニフェストを利用したデプロイ

## 基本的な考え方

Docker ラボでは、必要なコンテナをひとつずつ手動で起動させましたが、マイクロサービスアーキテクチャで設計された実際のアプリケーションでは、利用するコンテナの数が膨大で、構成も複雑なため、手動での管理は困難です。

こうした多数のコンテナが相互に連携する環境のデプロイや、それらのスケールを管理するためのソリューションが、コンテナオーケストレーションです。

その一例として、その後の Docker Compose ラボでは、アプリケーションの全体像を単一の Compose ファイルにあらかじめ宣言的に記述することで、複雑な構成のアプリケーションでも簡単に管理できました。

しかし、**Docker Compose はあくまでも単一の Docker ホストに閉じた世界** の話で、ホストレベルの障害には耐えられません。もちろん、単一ホストでの動作で問題ない場合、気軽に何かを試したい場合、開発環境を簡単に整えたい場合などには非常に便利に使えますが、より高度な運用、例えば複数の Web サーバ用コンテナを動作させてロードバランスさせたい場合や、それらを動的に減らしたり増やしたりしたい場合には、Docker Compose では限界がありました。

そこで、そうした要件を満たせる、より高度なオーケストレーションが実現できるプラットフォームが登場してきました。Docker 社も Docker Swarm を提供していますが、最近では Kubernetes がデファクトスタンダードの地位を築きつつあります。Kubernetes の開発は Google です。これも、今回のハンズオンでGCP を利用する背景の一つです。

## 準備

### クラスタの作成

Kubernetes には、Kubenetes 自身と、それが管理するコンテナが動作するためのクラスタが必要です。まずは、このクラスタを作成します。

このラボでは、GCP 上の Kubernetes クラスタで Kubernetes を動作させます。Kubernetes クラスタを作成していない場合は、次の手順を実行します。

- [📖 **Prep for Lab： Kubernetes クラスタの作成**](prep-k8s-cluster.md)

### リソースの取得

このラボでは、Kubernetes の操作は Google Cloud Shell を通じて行います。ラボで利用するリソースは GitHub 上のリポジトリで公開されていますので、Google Cloud Shell 上で次のコマンドで必要なリソースをクローンします。

```bash
cd ~
git clone https://github.com/piperjapan/codes.git
```
